<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sagittarius A* Overview with Calculator</title>
<style>
  body {
    margin: 0;
    background: radial-gradient(circle at center, #070010 0%, #000010 100%);
    color: white;
    font-family: 'Segoe UI', Arial, sans-serif;
    overflow-x: hidden;
    text-align: center;
  }
  canvas {
    display: block;
    margin: 0 auto;
    background: radial-gradient(circle at center, #12001c 0%, #000010 100%);
  }
  .label {
    position: absolute;
    color: #e5ccff;
    font-size: 14px;
    background: rgba(20, 0, 30, 0.6);
    padding: 5px 10px;
    border-radius: 6px;
    border: 1px solid rgba(120, 0, 180, 0.6);
    opacity: 0.9;
    pointer-events: auto;
  }
  .tooltip {
    position: absolute;
    max-width: 260px;
    font-size: 13px;
    line-height: 1.3em;
    padding: 8px;
    border-radius: 8px;
    background: rgba(30, 0, 50, 0.85);
    border: 1px solid #5a0090;
    color: #e5ccff;
    display: none;
  }
  #calculatorPanel {
    margin: 25px auto;
    padding: 15px 25px;
    max-width: 420px;
    background: rgba(25, 0, 40, 0.8);
    border: 1px solid #5a0090;
    border-radius: 10px;
    text-align: left;
    font-size: 14px;
  }
  #calculatorPanel input {
    width: 100%;
    margin-top: 4px;
    margin-bottom: 8px;
    background: #1a0030;
    color: #e5ccff;
    border: 1px solid #5a0090;
    border-radius: 4px;
    padding: 5px;
  }
  #calculatorPanel button {
    background: #8000ff;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    display: block;
    margin: 10px auto;
  }
  #calculatorPanel button:hover {
    background: #a64dff;
  }
  #calcResults {
    text-align: center;
    margin-top: 8px;
    font-size: 13px;
    color: #cdb7ff;
  }
</style>
</head>
<body>

<canvas id="overviewCanvas" width="900" height="500"></canvas>

<!-- Labels -->
<div id="labels">
  <div class="label" id="labelBH">Sagittarius A*</div>
  <div class="label" id="labelDisk">Accretion Disk</div>
  <div class="label" id="labelEH">Event Horizon</div>
  <div class="label" id="labelLens">Gravitational Lensing Zone</div>
</div>

<div id="tooltip" class="tooltip"></div>

<!-- Calculator -->
<div id="calculatorPanel">
  <strong>Sagittarius A* Time Dilation Calculator</strong><br><br>
  Radius r (m):<br>
  <input id="radiusInput" type="number" value="7.8e17" step="1e16">
  Dark Matter ρ<sub>DM</sub> (kg/m³):<br>
  <input id="densityInput" type="number" value="1e-21" step="1e-22">
  <button id="updateBtn">Run Calculation</button>
  <div id="calcResults"></div>
</div>

<script>
const canvas = document.getElementById('overviewCanvas');
const ctx = canvas.getContext('2d');
const w = canvas.width, h = canvas.height;
const cx = w/2, cy = h/2;
let t = 0;

// Stars
const stars = Array.from({length:180},()=>({
  x:Math.random()*w, y:Math.random()*h, tw:Math.random()*Math.PI*2, r:Math.random()*1.3
}));

// Physics constants
const G=6.67430e-11, M=4.3e6*1.989e30, c=3e8;
let radius=7.8e17, rho=1e-21;
let gamma = calcGamma(radius);
let hotspotAngle = 0;

// Hotspot trail
const trail = [];
const maxTrail = 80;

// Tooltip info
const info = {
  labelBH:"Sagittarius A* — the Milky Way’s central black hole (~4.3 million M☉).",
  labelDisk:"Accretion disk: heated gas orbiting near light speed, emitting X-rays.",
  labelEH:"Event horizon: boundary beyond which light cannot escape.",
  labelLens:"Lensing zone: starlight bends around the intense gravity field."
};
const tooltip = document.getElementById('tooltip');
document.querySelectorAll('.label').forEach(lbl=>{
  lbl.addEventListener('mouseenter',()=>{
    tooltip.innerText = info[lbl.id];
    tooltip.style.display='block';
  });
  lbl.addEventListener('mousemove',e=>{
    tooltip.style.left=(e.pageX+12)+'px';
    tooltip.style.top=(e.pageY+12)+'px';
  });
  lbl.addEventListener('mouseleave',()=>tooltip.style.display='none');
});

function calcGamma(r){
  const val = 1 - (G*M)/(r*c*c);
  return val>0 ? Math.sqrt(val) : 0;
}

let mouseX=0, mouseY=0;
document.addEventListener('mousemove', e=>{
  mouseX = (e.clientX - cx)/w;
  mouseY = (e.clientY - cy)/h;
});

function drawScene(){
  ctx.clearRect(0,0,w,h);
  // Stars
  for(const s of stars){
    s.tw+=0.02;
    const bright=0.6+0.4*Math.sin(s.tw);
    const bx=s.x+mouseX*20*s.r, by=s.y+mouseY*20*s.r;
    ctx.beginPath();
    ctx.arc(bx,by,s.r,0,2*Math.PI);
    ctx.fillStyle=`rgba(255,255,255,${bright})`;
    ctx.fill();
  }

  // Accretion disk
  const diskGrad = ctx.createRadialGradient(cx,cy,50,cx,cy,180);
  diskGrad.addColorStop(0,'rgba(255,160,60,0.2)');
  diskGrad.addColorStop(0.5,'rgba(255,100,0,0.08)');
  diskGrad.addColorStop(1,'rgba(100,0,150,0.05)');
  ctx.save();
  ctx.translate(cx,cy);
  ctx.rotate(0.1*Math.sin(t/100));
  ctx.scale(1,0.6);
  ctx.beginPath();
  ctx.arc(0,0,160,0,2*Math.PI);
  ctx.fillStyle=diskGrad;
  ctx.fill();

  // Rotating hotspot
  const speed = (0.02 + (1-gamma)*0.5);
  const xh = Math.cos(hotspotAngle)*100;
  const yh = Math.sin(hotspotAngle)*40;
  hotspotAngle += speed;
  trail.push({x:xh, y:yh});
  if(trail.length>maxTrail) trail.shift();

  // Draw trail
  for(let i=0;i<trail.length;i++){
    const alpha = i/trail.length;
    ctx.beginPath();
    ctx.arc(trail[i].x, trail[i].y, 3, 0, 2*Math.PI);
    ctx.fillStyle=`rgba(255,200,100,${alpha*0.6})`;
    ctx.fill();
  }

  // Hotspot itself
  ctx.beginPath();
  ctx.arc(xh,yh,6,0,2*Math.PI);
  ctx.fillStyle='rgba(255,220,150,0.95)';
  ctx.shadowColor='rgba(255,180,80,0.6)';
  ctx.shadowBlur=20;
  ctx.fill();
  ctx.shadowBlur=0;
  ctx.restore();

  // Event horizon
  const horizonGrad = ctx.createRadialGradient(cx,cy,10,cx,cy,80);
  horizonGrad.addColorStop(0,'black');
  horizonGrad.addColorStop(1,'rgba(40,0,60,0.9)');
  ctx.beginPath();
  ctx.arc(cx,cy,80,0,2*Math.PI);
  ctx.fillStyle=horizonGrad;
  ctx.fill();

  // Halo based on rho
  const glow = 3 + Math.sin(t/20)*1.5;
  const glowAlpha = 0.4 + Math.min(rho*1e21,1)*0.5;
  ctx.beginPath();
  ctx.arc(cx,cy,82,0,2*Math.PI);
  ctx.strokeStyle=`rgba(200,100,255,${glowAlpha})`;
  ctx.lineWidth=glow;
  ctx.stroke();

  // Gravitational lens halo
  const flareGrad = ctx.createRadialGradient(cx,cy,0,cx,cy,300);
  flareGrad.addColorStop(0,`rgba(120,0,255,${0.05+rho*1e21*0.1})`);
  flareGrad.addColorStop(1,'rgba(0,0,0,0)');
  ctx.fillStyle=flareGrad;
  ctx.fillRect(0,0,w,h);

  // Label positions
  document.getElementById('labelBH').style.left=(cx-150)+'px';
  document.getElementById('labelBH').style.top=(cy-110)+'px';
  document.getElementById('labelDisk').style.left=(cx+120)+'px';
  document.getElementById('labelDisk').style.top=(cy-10)+'px';
  document.getElementById('labelEH').style.left=(cx-60)+'px';
  document.getElementById('labelEH').style.top=(cy+70)+'px';
  document.getElementById('labelLens').style.left=(cx-220)+'px';
  document.getElementById('labelLens').style.top=(cy+150)+'px';

  t++;
  requestAnimationFrame(drawScene);
}
drawScene();

// Calculator
document.getElementById('updateBtn').addEventListener('click',()=>{
  radius=parseFloat(document.getElementById('radiusInput').value);
  rho=parseFloat(document.getElementById('densityInput').value);
  gamma = calcGamma(radius);
  const Gamma_dark=1*(1+1e21*rho);
  document.getElementById('calcResults').innerHTML=
    `<small>γ = ${gamma.toFixed(6)}<br>Γ_dark = ${Gamma_dark.toExponential(2)}</small>`;
});
</script>
</body>
</html>
