<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸŒ€ BBH Simulation â€“ Time & Frequency</title>

  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      background: #0b0b0b;
      color: #e6e6e6;
      text-align: center;
      padding: 1.5rem;
    }
    h1 {
      color: #00b4ff;
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }
    canvas {
      display: block;
      margin: 1.2rem auto;
      background: #111;
      border-radius: 12px;
      max-width: 800px;
      width: 95%;
      height: 400px;
    }
    footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #aaa;
    }
  </style>
</head>
<body>
  <h1>ðŸŒ€ Mock Gravitational Wave â€“ Time & Frequency</h1>
  <p>(Offline version â€“ works without internet)</p>

  <canvas id="timePlot" width="800" height="400"></canvas>
  <canvas id="freqPlot" width="800" height="400"></canvas>

  <script>
    // --- Helper math functions ---
    function fftReIm(signal) {
      // Naive FFT implementation (slow but okay for demo)
      const N = signal.length;
      const outRe = new Array(N).fill(0);
      const outIm = new Array(N).fill(0);
      for (let k = 0; k < N; k++) {
        for (let n = 0; n < N; n++) {
          const angle = (2 * Math.PI * k * n) / N;
          outRe[k] += signal[n] * Math.cos(angle);
          outIm[k] -= signal[n] * Math.sin(angle);
        }
      }
      const mag = outRe.map((re, i) => Math.sqrt(re * re + outIm[i] * outIm[i]) / N);
      return mag.slice(0, N / 2);
    }

    // --- Generate waveform data ---
    const N = 2000;
    const t = Array.from({ length: N }, (_, i) => i * 0.05);
    const hPlus = t.map(x => Math.sin(0.2 * x) * Math.exp(-0.002 * x));
    const hCross = t.map(x => Math.cos(0.2 * x) * Math.exp(-0.002 * x));

    // --- Draw time-domain plot ---
    const timeCanvas = document.getElementById('timePlot');
    const ctxT = timeCanvas.getContext('2d');
    const w = timeCanvas.width;
    const h = timeCanvas.height;
    const maxVal = Math.max(...hPlus.map(Math.abs), ...hCross.map(Math.abs));
    const scaleY = h / (2.2 * maxVal);
    const stepX = w / N;

    function drawWave(ctx, data, color, offset) {
      ctx.beginPath();
      ctx.strokeStyle = color;
      ctx.lineWidth = 2;
      data.forEach((v, i) => {
        const x = i * stepX;
        const y = h / 2 - v * scaleY + offset;
        i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
      });
      ctx.stroke();
    }

    ctxT.fillStyle = "#111";
    ctxT.fillRect(0, 0, w, h);
    ctxT.strokeStyle = "#333";
    for (let i = 0; i < 10; i++) {
      const y = (i / 10) * h;
      ctxT.beginPath();
      ctxT.moveTo(0, y);
      ctxT.lineTo(w, y);
      ctxT.stroke();
    }
    drawWave(ctxT, hPlus, "#00b4ff", -5);
    drawWave(ctxT, hCross, "#ffffff", +5);
    ctxT.fillStyle = "#e6e6e6";
    ctxT.font = "16px system-ui";
    ctxT.fillText("hâ‚Š (blue)", 20, 25);
    ctxT.fillText("hÃ— (white)", 20, 45);
    ctxT.fillText("Time Domain", w - 180, 25);

    // --- Frequency-domain ---
    const hPlusFFT = fftReIm(hPlus);
    const freq = Array.from({ length: N / 2 }, (_, i) => i / (N * 0.05));
    const maxAmp = Math.max(...hPlusFFT);
    const fCanvas = document.getElementById('freqPlot');
    const ctxF = fCanvas.getContext('2d');
    const wf = fCanvas.width;
    const hf = fCanvas.height;
    const scaleYf = hf / (1.2 * maxAmp);
    const stepXf = wf / (N / 2);

    ctxF.fillStyle = "#111";
    ctxF.fillRect(0, 0, wf, hf);
    ctxF.strokeStyle = "#333";
    for (let i = 0; i < 10; i++) {
      const y = (i / 10) * hf;
      ctxF.beginPath();
      ctxF.moveTo(0, y);
      ctxF.lineTo(wf, y);
      ctxF.stroke();
    }
    ctxF.beginPath();
    ctxF.strokeStyle = "#00ff88";
    ctxF.lineWidth = 2;
    hPlusFFT.forEach((v, i) => {
      const x = i * stepXf;
      const y = hf - v * scaleYf;
      i === 0 ? ctxF.moveTo(x, y) : ctxF.lineTo(x, y);
    });
    ctxF.stroke();
    ctxF.fillStyle = "#e6e6e6";
    ctxF.font = "16px system-ui";
    ctxF.fillText("Frequency Domain (FFT)", wf - 260, 25);
    ctxF.fillText("Amplitude Spectrum", 20, 25);
  </script>

  <footer>
    <p>BBH-Sim Open Project â€¢ Offline Visualization (Time & Frequency)</p>
  </footer>
</body>
</html>
