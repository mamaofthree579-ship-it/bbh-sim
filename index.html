<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Black Hole & Gravitational-Wave Simulator</title>
<style>
body {
  margin:0; font-family:Arial,sans-serif;
  background:#05000a; color:white; overflow-x:hidden;
}
.tabs { display:flex; background:#1a001f; border-bottom:2px solid #33003d; }
.tabButton {
  flex:1; padding:12px; cursor:pointer; background:#22002b;
  border:none; color:#e5ccff; font-weight:bold; transition:0.3s;
}
.tabButton:hover { background:#33003d; }
.tabButton.active { background:#550066; color:white; }
.tabContent { display:none; padding:20px; }
canvas {
  border:1px solid #33003d; border-radius:8px;
  display:block; margin:15px auto;
  background:radial-gradient(circle at center,#14001a 0%,#05000a 100%);
}
button, select, input {
  margin:5px 0; padding:8px; border:none; border-radius:4px;
}
button {
  background:#8000ff; color:white; cursor:pointer; transition:0.3s;
}
button:hover { background:#a64dff; }
#eventInfo, #scienceSummary, #decayPanel {
  background:rgba(30,0,40,0.7); padding:10px;
  border-radius:8px; margin-top:10px; border:1px solid #33003d;
}
#scienceSummary table { width:100%; border-collapse:collapse; margin-top:5px; }
#scienceSummary th,#scienceSummary td {
  text-align:left; padding:6px; border-bottom:1px solid #440055; color:#e5ccff;
}
h2,h3,h4 { color:#e5ccff; }
.legendBox {
  display:flex; gap:15px; justify-content:center; margin-top:10px;
  font-size:14px; color:#e5ccff;
}
.legendItem::before {
  content:""; display:inline-block; width:12px; height:12px;
  margin-right:6px; border-radius:50%;
}
.legendItem.bh::before { background:#5500aa; }
.legendItem.disk::before { background:#ff7700; }
.legendItem.warp::before { background:#0099ff; }
.sliderGroup { display:flex; align-items:center; gap:10px; margin:5px 0; }
.sliderGroup label { width:120px; }
</style>
</head>
<body>

<!-- Tabs -->
<div class="tabs">
  <button class="tabButton active" data-tab="overviewTab">Overview</button>
  <button class="tabButton" data-tab="eventsTab">Events</button>
</div>

<!-- Overview -->
<div id="overviewTab" class="tabContent" style="display:block;">
  <h2>üåå Black Hole Overview</h2>
  <p>Observe a rotating black hole, its glowing accretion disk, and warped starlight. Colored outlines mark key regions.</p>
  <canvas id="bhCanvas" width="800" height="400"></canvas>
  <div class="legendBox">
    <span class="legendItem bh">Event Horizon</span>
    <span class="legendItem disk">Accretion Disk</span>
    <span class="legendItem warp">Spacetime Warp</span>
  </div>
</div>

<!-- Events -->
<div id="eventsTab" class="tabContent">
  <h2>üí´ Gravitational-Wave Events</h2>
  <label for="eventSelect">Select Event:</label>
  <select id="eventSelect"></select>
  <button id="runCustomBtn">Run Custom Simulation</button>
  <button id="resetBtn">Reset</button><br>

  <label>M‚ÇÅ (M‚òâ):</label><input id="m1Input" type="number" value="30" step="0.1">
  <label>M‚ÇÇ (M‚òâ):</label><input id="m2Input" type="number" value="30" step="0.1">
  <label>Spin (a*):</label><input id="spinInput" type="number" value="0.5" step="0.1" min="0" max="1"><br>

  <canvas id="orbitCanvas" width="700" height="400"></canvas>
  <canvas id="chirpCanvas" width="800" height="200"></canvas>
  <button id="playChirpBtn">üîä Play Chirp</button>

  <div id="decayPanel">
    <h3>üåÄ Decay + Dark-Matter Calculator</h3>
    <div class="sliderGroup">
      <label>Radius r (m):</label>
      <input type="range" id="rInput" min="1e7" max="1e10" value="1e9" step="1e7">
    </div>
    <div class="sliderGroup">
      <label>œÅ<sub>DM</sub> (kg/m¬≥):</label>
      <input type="range" id="rhoInput" min="0" max="1e-20" value="1e-22" step="1e-23">
    </div>
    <div class="sliderGroup">
      <label>Œ± (coefficient):</label>
      <input type="range" id="alphaInput" min="0" max="5e20" value="1e20" step="1e19">
    </div>
    <label><input type="checkbox" id="quantumToggle"> Include QŒºŒΩ (Quantum Correction)</label>
    <p><strong>Œì Effective :</strong> <span id="gammaOut">--</span></p>
  </div>

  <div id="eventInfo">
    <strong>Event Information:</strong>
    <p id="eventDescription"></p>
  </div>

  <div id="scienceSummary">
    <strong>Scientific Summary:</strong>
    <table>
      <tr><th>Parameter</th><th>Value</th></tr>
      <tr><td>Chirp Mass (‚Ñ≥)</td><td id="chirpMass">--</td></tr>
      <tr><td>Frequency Range (Hz)</td><td id="freqRange">--</td></tr>
      <tr><td>GW Strain (h)</td><td id="gwStrain">--</td></tr>
      <tr><td>Estimated Distance</td><td id="distance">--</td></tr>
    </table>
    <h4>Chirp Amplitude</h4><canvas id="amplitudeCanvas" width="800" height="200"></canvas>
    <h4>Energy Loss</h4><canvas id="energyCanvas" width="800" height="200"></canvas>
    <h4>Frequency Evolution</h4><canvas id="freqCanvas" width="800" height="200"></canvas>
  </div>
</div>

<script>
// --- Tabs ---
const tabButtons=document.querySelectorAll('.tabButton');
const tabContents=document.querySelectorAll('.tabContent');
tabButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    tabButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    tabContents.forEach(tc=>tc.style.display='none');
    document.getElementById(btn.dataset.tab).style.display='block';
  });
});

// --- Overview with masked stars + outlines ---
const bhCanvas=document.getElementById('bhCanvas');
const bhCtx=bhCanvas.getContext('2d');
const stars=Array.from({length:150},()=>({
  x:Math.random()*bhCanvas.width,
  y:Math.random()*bhCanvas.height,
  r:Math.random()*1.2,
  tw:Math.random()*2*Math.PI
}));
let bhAngle=0;
function drawBH(){
  bhCtx.clearRect(0,0,bhCanvas.width,bhCanvas.height);
  const cx=bhCanvas.width/2, cy=bhCanvas.height/2, rBH=70;
  stars.forEach(s=>{
    s.tw+=0.05;
    const bright=0.6+0.4*Math.sin(s.tw);
    if(Math.hypot(s.x-cx,s.y-cy)>rBH+10){
      bhCtx.beginPath(); bhCtx.arc(s.x,s.y,s.r,0,2*Math.PI);
      bhCtx.fillStyle=`rgba(255,255,255,${bright})`; bhCtx.fill();
    }
  });
  // disk gradient
  const grad=bhCtx.createRadialGradient(cx,cy,10,cx,cy,250);
  grad.addColorStop(0,'#000');
  grad.addColorStop(0.4,'#220022');
  grad.addColorStop(0.6,'#33003d');
  grad.addColorStop(1,'#05000a');
  bhCtx.fillStyle=grad; bhCtx.fillRect(0,0,bhCanvas.width,bhCanvas.height);
  // outlines
  bhCtx.strokeStyle="#5500aa"; bhCtx.lineWidth=2;
  bhCtx.beginPath(); bhCtx.arc(cx,cy,rBH,0,2*Math.PI); bhCtx.stroke(); // event horizon
  bhCtx.strokeStyle="#ff7700"; bhCtx.beginPath(); bhCtx.arc(cx,cy,110,0,2*Math.PI); bhCtx.stroke(); // accretion disk
  bhCtx.strokeStyle="#0099ff"; bhCtx.beginPath(); bhCtx.arc(cx,cy,160,0,2*Math.PI); bhCtx.stroke(); // warp zone
  // rotating marker
  const x=cx+Math.cos(bhAngle)*100, y=cy+Math.sin(bhAngle)*40;
  bhCtx.beginPath(); bhCtx.arc(x,y,6,0,2*Math.PI);
  bhCtx.fillStyle='#ffcc99'; bhCtx.fill();
  bhAngle+=0.03;
  requestAnimationFrame(drawBH);
}
drawBH();

// --- Events Data ---
const gwEvents={
  "GW150914":{m1:36,m2:29,spin:0.3,color:"#ff99cc"},
  "GW170104":{m1:31,m2:19,spin:0.5,color:"#99ccff"},
  "Custom":{m1:30,m2:30,spin:0.5,color:"#a64dff"}
};
const eventDescriptions={
  "GW150914":"First detection (2015): 36 + 29 M‚òâ merged ~1.3 B ly away.",
  "GW170104":"Detected 2017: 31 + 19 M‚òâ merged ~3 B ly away.",
  "Custom":"Custom system based on chosen parameters."
};
const eventSelect=document.getElementById('eventSelect');
for(const e in gwEvents){const o=document.createElement('option');o.value=e;o.text=e;eventSelect.add(o);}

// --- Orbit Animation ---
const orbitCanvas=document.getElementById('orbitCanvas');
const orbitCtx=orbitCanvas.getContext('2d');
let orbitAngle=0, orbitAnim;
function drawOrbit(m1,m2,spin,color,intensity){
  cancelAnimationFrame(orbitAnim);
  function animate(){
    orbitCtx.clearRect(0,0,orbitCanvas.width,orbitCanvas.height);
    const cx=orbitCanvas.width/2, cy=orbitCanvas.height/2;
    const r1=80, r2=160;
    const x1=cx+Math.cos(orbitAngle)*r1, y1=cy+Math.sin(orbitAngle)*r1;
    const x2=cx-Math.cos(orbitAngle)*r2, y2=cy-Math.sin(orbitAngle)*r2;
    const grad=orbitCtx.createRadialGradient(cx,cy,50,cx,cy,300);
    grad.addColorStop(0,'rgba(40,0,70,0.6)');
    grad.addColorStop(1,'rgba(0,0,0,1)');
    orbitCtx.fillStyle=grad; orbitCtx.fillRect(0,0,orbitCanvas.width,orbitCanvas.height);
    orbitCtx.beginPath(); orbitCtx.arc(x1,y1,10,0,2*Math.PI);
    orbitCtx.fillStyle=color; orbitCtx.globalAlpha=intensity; orbitCtx.fill();
    orbitCtx.beginPath(); orbitCtx.arc(x2,y2,16,0,2*Math.PI);
    orbitCtx.fillStyle="#00ccff"; orbitCtx.fill();
    orbitCtx.globalAlpha=1;
    orbitAngle+=0.025+spin*0.01;
    orbitAnim=requestAnimationFrame(animate);
  }
  animate();
}

// --- Graph Helper ---
function drawGraph(ctx,color,func){
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
  ctx.beginPath();
  for(let i=0;i<ctx.canvas.width;i++){
    const t=i/ctx.canvas.width;
    const y=ctx.canvas.height/2 - func(t)*ctx.canvas.height/3;
    if(i===0) ctx.moveTo(i,y); else ctx.lineTo(i,y);
  }
  ctx.strokeStyle=color; ctx.lineWidth=2; ctx.stroke();
}

// --- Chirp Sound ---
function playChirp(fStart,fEnd,duration,intensity){
  const audio=new (window.AudioContext||window.webkitAudioContext)();
  const osc=audio.createOscillator();
  const gain=audio.createGain();
  osc.connect(gain); gain.connect(audio.destination);
  osc.type="sine";
  osc.frequency.setValueAtTime(fStart,audio.currentTime);
  osc.frequency.exponentialRampToValueAtTime(fEnd,audio.currentTime+duration);
  gain.gain.setValueAtTime(0.15*intensity,audio.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.0001,audio.currentTime+duration);
  osc.start(); osc.stop(audio.currentTime+duration);
}

// --- Summary ---
function updateSummary(m1,m2){
  const chirpMass=Math.pow((m1*m2)**(3/5)/(m1+m2)**(1/5),1);
  document.getElementById('chirpMass').textContent=chirpMass.toFixed(2)+" M‚òâ";
  document.getElementById('freqRange').textContent="20‚Äì400 Hz";
  document.getElementById('gwStrain').textContent=(4e-21*(chirpMass/30)**(5/3)).toExponential(2);
  document.getElementById('distance').textContent=`${(chirpMass*40).toFixed(0)} million ly`;
}

// --- Decay + Dark-Matter Model ---
function computeGamma(){
  const G=6.67430e-11, c=3e8, M=4.3e6*1.989e30;
  const r=parseFloat(document.getElementById('rInput').value);
  const rho=parseFloat(document.getElementById('rhoInput').value);
  const alpha=parseFloat(document.getElementById('alphaInput').value);
  const quantum=document.getElementById('quantumToggle').checked;
  const gammaTime=Math.sqrt(1 - (2*G*M)/(r*c*c));
  const gammaDark=1 + alpha*rho;
  let gammaEff=gammaTime*gammaDark;
  if(quantum) gammaEff*=1.05; // mild quantum correction
  document.getElementById('gammaOut').textContent=gammaEff.toExponential(3);
  return gammaEff;
}

// --- Event Updater ---
function updateEvent(key){
  const ev=gwEvents[key];
  document.getElementById('eventDescription').textContent=eventDescriptions[key];
  const intensity=computeGamma();
  drawOrbit(ev.m1,ev.m2,ev.spin,ev.color,intensity);
  updateSummary(ev.m1,ev.m2);
  drawGraph(document.getElementById('amplitudeCanvas').getContext('2d'),'#a64dff',t=>Math.pow(t,3)*Math.sin(20*t*Math.PI*5));
  drawGraph(document.getElementById('energyCanvas').getContext('2d'),'#ff66ff',t=>Math.pow(t,2.5)*Math.exp(-3*t));
  drawGraph(document.getElementById('freqCanvas').getContext('2d'),'#00ccff',t=>t*t);
}

// --- Controls ---
document.getElementById('runCustomBtn').addEventListener('click',()=>{
  const m1=parseFloat(document.getElementById('m1Input').value);
  const m2=parseFloat(document.getElementById('m2Input').value);
  const spin=parseFloat(document.getElementById('spinInput').value);
  gwEvents["Custom"]={m1,m2,spin,color:"#a64dff"};
  eventDescriptions["Custom"]=`Custom system m1=${m1} M‚òâ m2=${m2} M‚òâ spin=${spin}`;
  eventSelect.value="Custom"; updateEvent("Custom");
});
document.getElementById('resetBtn').addEventListener('click',()=>updateEvent(eventSelect.value));
document.getElementById('playChirpBtn').addEventListener('click',()=>{
  const ev=gwEvents[eventSelect.value];
  const chirpMass=Math.pow((ev.m1*ev.m2)**(3/5)/(ev.m1+ev.m2)**(1/5),1);
  const fStart=30+ev.spin*10, fEnd=300+(chirpMass/30)*300;
  const duration=Math.max(0.5,3-(chirpMass/40));
  const intensity=computeGamma();
  playChirp(fStart,fEnd,duration,intensity);
});
["rInput","rhoInput","alphaInput","quantumToggle"].forEach(id=>{
  document.getElementById(id).addEventListener('input',()=>updateEvent(eventSelect.value));
});
eventSelect.addEventListener('change',()=>updateEvent(eventSelect.value));

// --- Init ---
updateEvent("GW150914");
</script>
</body>
</html>
