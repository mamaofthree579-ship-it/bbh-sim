 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BBH-Sim Visualizer</title>
<style>
  :root { --bg:#0b0b0b; --panel:#111; --accent:#00b4ff; --muted:#888; --text:#e6e6e6;}
  body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial;}
  header{padding:14px 16px;text-align:center;border-bottom:1px solid rgba(255,255,255,0.08)}
  h1{margin:0;font-size:1.25rem;color:var(--accent)}
  p.lead{margin:6px 0 0;color:var(--muted);font-size:0.95rem}
  .toolbar{display:flex;gap:8px;justify-content:center;padding:12px;flex-wrap:wrap}
  .tabbtn{background:transparent;border:1px solid rgba(255,255,255,0.08);color:var(--text);
          padding:8px 12px;border-radius:8px;font-weight:600}
  .tabbtn.active{background:linear-gradient(90deg,rgba(0,180,255,0.15),rgba(0,140,210,0.1));
                 border-color:rgba(0,180,255,0.4)}
  main{padding:12px;display:flex;flex-direction:column;align-items:center;gap:12px}
  .panel{background:var(--panel);width:95%;max-width:920px;border-radius:12px;padding:12px}
  canvas{display:block;width:100%;height:360px;border-radius:8px;background:#000}
  .controls{display:flex;gap:8px;align-items:center;justify-content:center;margin-top:8px;flex-wrap:wrap}
  button{background:var(--accent);color:#000;border:none;padding:8px 12px;border-radius:8px;font-weight:700;cursor:pointer}
  button.ghost{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,0.1)}
  .small{font-size:0.9rem;padding:6px 8px}
  .muted{color:var(--muted);font-size:0.9rem;text-align:center;margin-top:6px}
  footer{padding:14px;text-align:center;color:var(--muted);font-size:0.85rem}
</style>
</head>
<body>
<header>
  <h1>BBH-Sim Visualizer</h1>
  <p class="lead">Switch between Time/Frequency & Animated views</p>
</header>

<div class="toolbar">
  <button class="tabbtn active" data-view="timefreq">Time & Frequency</button>
  <button class="tabbtn" data-view="chirp">Animated Chirp</button>
  <button class="tabbtn" data-view="dual">Dual Polarization</button>
</div>

<main>
  <section id="timefreq" class="panel view">
    <h2 style="color:var(--accent);margin-top:0">Time & Frequency</h2>
    <canvas id="timeCanvas"></canvas>
    <canvas id="freqCanvas" style="height:240px"></canvas>
    <div class="controls">
      <button id="refreshStatic" class="small ghost">Refresh</button>
    </div>
    <div class="muted">Static plots of mock waveform and FFT spectrum</div>
  </section>

  <section id="chirp" class="panel view" style="display:none">
    <h2 style="color:var(--accent);margin-top:0">Animated Chirp</h2>
    <canvas id="chirpCanvas"></canvas>
    <div class="controls">
      <button id="playChirp">▶ Play</button>
      <button id="resetChirp" class="ghost small">Reset</button>
    </div>
    <div class="muted">Single polarization (h₊)</div>
  </section>

  <section id="dual" class="panel view" style="display:none">
    <h2 style="color:var(--accent);margin-top:0">Dual Polarization</h2>
    <canvas id="dualCanvas"></canvas>
    <div class="controls">
      <button id="playDual">▶ Play</button>
      <button id="pauseDual" class="ghost small">Pause</button>
    </div>
    <div class="muted">h₊ (teal) & h× (magenta)</div>
  </section>
</main>

<footer>BBH-Sim demo — mock waveform visualizer</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {

// ---------- mock data ----------
const N=1500, dt=0.0005;
const t=Array.from({length:N},(_,i)=>i*dt);
const f_start=30, f_end=250;
const f_t=t.map(x=>f_start+(f_end-f_start)*(x/t[t.length-1])**2);
const amp=t.map(x=>(x/t[t.length-1])**3);
const hPlus=t.map((x,i)=>amp[i]*Math.sin(2*Math.PI*f_t[i]*x)*Math.exp(-x*80));
const hCross=t.map((x,i)=>amp[i]*Math.cos(2*Math.PI*f_t[i]*x)*Math.exp(-x*80));

// ---------- Draw Time/Freq ----------
function fftMag(sig){
  const n=sig.length;const re=new Array(n).fill(0),im=new Array(n).fill(0);
  for(let k=0;k<n;k++){for(let j=0;j<n;j++){const a=2*Math.PI*k*j/n;re[k]+=sig[j]*Math.cos(a);im[k]-=sig[j]*Math.sin(a);}}
  return re.map((r,i)=>Math.sqrt(r*r+im[i]*im[i])/n).slice(0,n/2);
}
function drawTimeFreq(){
  const timeC=document.getElementById('timeCanvas');
  const freqC=document.getElementById('freqCanvas');
  const ctxT=timeC.getContext('2d'), ctxF=freqC.getContext('2d');
  const w=timeC.width=timeC.clientWidth, h=timeC.height=360;
  ctxT.fillStyle='#000';ctxT.fillRect(0,0,w,h);
  ctxT.strokeStyle='#00b4ff';ctxT.beginPath();
  for(let i=0;i<N;i++){const x=i/N*w, y=h/2-hPlus[i]*160; i?ctxT.lineTo(x,y):ctxT.moveTo(x,y);}ctxT.stroke();
  ctxT.strokeStyle='#fff';ctxT.beginPath();
  for(let i=0;i<N;i++){const x=i/N*w, y=h/2-hCross[i]*160; i?ctxT.lineTo(x,y):ctxT.moveTo(x,y);}ctxT.stroke();

  const mag=fftMag(hPlus);
  const wf=freqC.width=freqC.clientWidth, hf=freqC.height=240;
  const ctx2=freqC.getContext('2d');
  ctx2.fillStyle='#000';ctx2.fillRect(0,0,wf,hf);
  ctx2.strokeStyle='#00ff88';ctx2.beginPath();
  for(let i=0;i<mag.length;i++){const x=i/mag.length*wf, y=hf-(mag[i]/Math.max(...mag))*200; i?ctx2.lineTo(x,y):ctx2.moveTo(x,y);}
  ctx2.stroke();
}

// ---------- Animated Chirp ----------
(function(){
  const c=document.getElementById('chirpCanvas'), ctx=c.getContext('2d');
  let i=0, run=false;
  function draw(k){const w=c.width=c.clientWidth,h=c.height=360;ctx.fillStyle='#000';ctx.fillRect(0,0,w,h);
    ctx.strokeStyle='#00b4ff';ctx.beginPath();
    for(let j=0;j<k;j++){const x=j/N*w,y=h/2-hPlus[j]*160;j?ctx.lineTo(x,y):ctx.moveTo(x,y);}ctx.stroke();}
  function step(){draw(i);i+=8;if(i<N&&run)requestAnimationFrame(step);else run=false;}
  document.getElementById('playChirp').onclick=()=>{if(!run){run=true;i=0;step();}};
  document.getElementById('resetChirp').onclick=()=>{i=0;draw(0);run=false;};
  draw(0);
})();

// ---------- Dual Polarization ----------
(function(){
  const c=document.getElementById('dualCanvas'), ctx=c.getContext('2d');
  let i=0, run=false;
  function draw(k){const w=c.width=c.clientWidth,h=c.height=360;ctx.fillStyle='#000';ctx.fillRect(0,0,w,h);
    ctx.strokeStyle='#00ffcc';ctx.beginPath();
    for(let j=0;j<k;j++){const x=j/N*w,y=h/2-hPlus[j]*160;j?ctx.lineTo(x,y):ctx.moveTo(x,y);}ctx.stroke();
    ctx.strokeStyle='#ff66ff';ctx.beginPath();
    for(let j=0;j<k;j++){const x=j/N*w,y=h/2-hCross[j]*160-40;j?ctx.lineTo(x,y):ctx.moveTo(x,y);}ctx.stroke();}
  function step(){draw(i);i+=8;if(i<N&&run)requestAnimationFrame(step);else run=false;}
  document.getElementById('playDual').onclick=()=>{if(!run){run=true;i=0;step();}};
  document.getElementById('pauseDual').onclick=()=>{run=false;};
  draw(0);
})();

// ---------- Tabs ----------
document.querySelectorAll('.tabbtn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.tabbtn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const v=btn.dataset.view;
    document.querySelectorAll('.view').forEach(sec=>{
      sec.style.display = (sec.id===v)?'block':'none';
    });
    if(v==='timefreq') drawTimeFreq();
  });
});

// Initial draw
drawTimeFreq();

});
</script>
</body>
</html>
