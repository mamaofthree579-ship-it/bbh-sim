<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Black Hole & Gravitational-Wave Simulator</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#05000a; color:white; overflow-x:hidden; }
.tabs { display:flex; background:#1a001f; border-bottom:2px solid #33003d; }
.tabButton { flex:1; padding:12px; cursor:pointer; background:#22002b; border:none; color:#e5ccff; font-weight:bold; transition:0.3s; }
.tabButton:hover { background:#33003d; }
.tabButton.active { background:#550066; color:white; }
.tabContent { display:none; padding:20px; }
canvas { border:1px solid #33003d; border-radius:8px; display:block; margin:15px auto; background:radial-gradient(circle at center, #14001a 0%, #05000a 100%); }
button, select, input { margin:5px; padding:8px; border:none; border-radius:4px; }
button { background:#8000ff; color:white; cursor:pointer; transition:0.3s; }
button:hover { background:#a64dff; }
#eventInfo, #scienceSummary, #calcResults { background:rgba(30,0,40,0.7); padding:10px; border-radius:8px; margin-top:10px; border:1px solid #33003d; }
#scienceSummary table { width:100%; border-collapse:collapse; margin-top:5px; }
#scienceSummary th, #scienceSummary td { text-align:left; padding:6px; border-bottom:1px solid #440055; color:#e5ccff; }
h2,h3,h4 { color:#e5ccff; }
</style>
</head>
<body>

<!-- Tabs -->
<div class="tabs">
  <button class="tabButton active" data-tab="overviewTab">Overview</button>
  <button class="tabButton" data-tab="eventsTab">Events</button>
  <button class="tabButton" data-tab="calculatorsTab">Calculators</button>
</div>

<!-- Overview -->
<div id="overviewTab" class="tabContent" style="display:block;">
  <h2>üåå Black Hole Overview</h2>
  <p>Observe a rotating black hole surrounded by a glowing accretion disk and distant stars, warped by extreme gravity.</p>
  <canvas id="bhCanvas" width="800" height="400"></canvas>
</div>

<!-- Events -->
<div id="eventsTab" class="tabContent">
  <h2>üí´ Gravitational-Wave Events</h2>
  <label for="eventSelect">Select Event:</label>
  <select id="eventSelect"></select>
  <button id="runCustomBtn">Run Custom Simulation</button>
  <button id="resetBtn">Reset Simulation</button><br>

  <label>M‚ÇÅ (M‚òâ):</label><input id="m1Input" type="number" value="30" step="0.1">
  <label>M‚ÇÇ (M‚òâ):</label><input id="m2Input" type="number" value="30" step="0.1">
  <label>Spin (a*):</label><input id="spinInput" type="number" value="0.5" step="0.1" min="0" max="1"><br>
  
  <canvas id="orbitCanvas" width="700" height="400"></canvas>
  <canvas id="chirpCanvas" width="800" height="200"></canvas>
  <button id="playChirpBtn">üîä Play Chirp</button>

  <div id="eventInfo">
    <strong>Event Information:</strong>
    <p id="eventDescription"></p>
  </div>

  <div id="scienceSummary">
    <strong>Scientific Summary:</strong>
    <table>
      <tr><th>Parameter</th><th>Value</th></tr>
      <tr><td>Chirp Mass (‚Ñ≥)</td><td id="chirpMass">--</td></tr>
      <tr><td>Frequency Range (Hz)</td><td id="freqRange">--</td></tr>
      <tr><td>GW Strain (h)</td><td id="gwStrain">--</td></tr>
      <tr><td>Estimated Distance</td><td id="distance">--</td></tr>
    </table>
    <h4>Chirp Amplitude</h4>
    <canvas id="amplitudeCanvas" width="800" height="200"></canvas>
    <h4>Energy Loss</h4>
    <canvas id="energyCanvas" width="800" height="200"></canvas>
    <h4>Frequency Evolution</h4>
    <canvas id="freqCanvas" width="800" height="200"></canvas>
  </div>
</div>

<!-- Calculators -->
<div id="calculatorsTab" class="tabContent">
  <h2>üßÆ Time Dilation & Dark Matter Effects</h2>
  <p>Simulate time dilation near Sagittarius A* and particle decay modifications under dark matter density.</p>
  
  <label>Radius from Black Hole (m):</label>
  <input id="radiusInput" type="number" value="7.8e17" step="1e16">
  <label>Dark Matter Density (œÅ_DM, kg/m¬≥):</label>
  <input id="densityInput" type="number" value="1e-21" step="1e-22">
  <button id="runCalcBtn">Run Simulation</button>

  <div id="calcResults"></div>
  <canvas id="decayCanvas" width="800" height="300"></canvas>
</div>

<script>
// --- Tabs ---
const tabButtons=document.querySelectorAll('.tabButton');
const tabContents=document.querySelectorAll('.tabContent');
tabButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    tabButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    tabContents.forEach(tc=>tc.style.display='none');
    document.getElementById(btn.dataset.tab).style.display='block';
  });
});

// --- Overview BH with swirling accretion disk ---
const bhCanvas=document.getElementById('bhCanvas');
const bhCtx=bhCanvas.getContext('2d');
const stars=Array.from({length:150},()=>({x:Math.random()*bhCanvas.width,y:Math.random()*bhCanvas.height,r:Math.random()*1.2,tw:Math.random()*2*Math.PI}));
let bhAngle=0, diskAngle=0;

function drawBH(){
  bhCtx.clearRect(0,0,bhCanvas.width,bhCanvas.height);
  const cx=bhCanvas.width/2, cy=bhCanvas.height/2, rBH=70;

  // Stars
  stars.forEach(s=>{
    s.tw+=0.05; const b=0.6+0.4*Math.sin(s.tw);
    if(Math.hypot(s.x-cx,s.y-cy)>rBH+20){
      bhCtx.beginPath(); bhCtx.arc(s.x,s.y,s.r,0,2*Math.PI); bhCtx.fillStyle=`rgba(255,255,255,${b})`; bhCtx.fill();
    }
  });

  // Background gradient
  const grad=bhCtx.createRadialGradient(cx,cy,10,cx,cy,200);
  grad.addColorStop(0,'#000'); grad.addColorStop(1,'#220033');
  bhCtx.fillStyle=grad; bhCtx.fillRect(0,0,bhCanvas.width,bhCanvas.height);

  // Black hole center
  bhCtx.beginPath(); bhCtx.arc(cx,cy,rBH,0,2*Math.PI); bhCtx.fillStyle='black'; bhCtx.fill();

  // Accretion disk with multi-color swirl
  for(let i=0;i<200;i+=2){
    const angle=i*0.03+diskAngle;
    const radius= rBH + 20 + i*0.3;
    const x = cx + radius * Math.cos(angle) * (1 + 0.2*Math.sin(diskAngle*3));
    const y = cy + radius * Math.sin(angle) * (1 + 0.1*Math.sin(diskAngle*5));
    bhCtx.beginPath();
    bhCtx.arc(x,y,2,0,2*Math.PI);
    const colorIntensity=Math.floor(150 + Math.sin(diskAngle*5+i*0.1)*50);
    bhCtx.fillStyle=`rgba(255,${colorIntensity},50,0.5)`;
    bhCtx.fill();
  }

  // Orbiting bright matter particle
  const x=cx+Math.cos(bhAngle)*100, y=cy+Math.sin(bhAngle)*40;
  bhCtx.beginPath(); bhCtx.arc(x,y,6,0,2*Math.PI); bhCtx.fillStyle='#ffcc99'; bhCtx.fill();

  bhAngle+=0.03;
  diskAngle+=0.02;
  requestAnimationFrame(drawBH);
}
drawBH();

// --- GW Events ---
const gwEvents={
  "GW150914":{m1:36,m2:29,spin:0.3,color:'#a64dff'},
  "GW170104":{m1:31,m2:19,spin:0.5,color:'#00ccff'},
  "GW190521":{m1:85,m2:66,spin:0.7,color:'#ff66ff'},
  "Custom":{m1:30,m2:30,spin:0.5,color:'#ffffff'}
};
const eventDescriptions={
  "GW150914":"First detection (2015): two black holes of 36 & 29 M‚òâ merged 1.3B ly away.",
  "GW170104":"Detected in 2017: 31 & 19 M‚òâ black holes merged ~3B ly away.",
  "GW190521":"Massive black holes (85 & 66 M‚òâ) merged producing the most energetic GW detected.",
  "Custom":"Custom system based on chosen parameters."
};
const eventSelect=document.getElementById('eventSelect');
for(let e in gwEvents){const opt=document.createElement('option');opt.value=e;opt.text=e;eventSelect.add(opt);}

// --- Orbit canvas with flashing merger effect ---
const orbitCanvas=document.getElementById('orbitCanvas');
const orbitCtx=orbitCanvas.getContext('2d');
let orbitAngle=0, animFrame;
function drawOrbit(ev, flash=0){
  orbitCtx.clearRect(0,0,orbitCanvas.width,orbitCanvas.height);
  const cx=orbitCanvas.width/2, cy=orbitCanvas.height/2;
  const r1=80, r2=160;
  const x1=cx+Math.cos(orbitAngle)*r1, y1=cy+Math.sin(orbitAngle)*r1;
  const x2=cx-Math.cos(orbitAngle)*r2, y2=cy-Math.sin(orbitAngle)*r2;

  if(flash>0){ orbitCtx.fillStyle=`rgba(255,255,200,${flash})`; orbitCtx.fillRect(0,0,orbitCanvas.width,orbitCanvas.height); }

  stars.forEach(s=>{
    let dx=s.x-cx, dy=s.y-cy, r=Math.sqrt(dx*dx+dy*dy);
    if(r>1){
      const theta=0.5*ev.spin/r;
      const lx=cx+dx*Math.cos(theta)-dy*Math.sin(theta);
      const ly=cy+dx*Math.sin(theta)+dy*Math.cos(theta);
      orbitCtx.beginPath(); orbitCtx.arc(lx,ly,s.r,0,2*Math.PI); orbitCtx.fillStyle='rgba(255,255,255,0.6)'; orbitCtx.fill();
    }
  });

  orbitCtx.beginPath(); orbitCtx.arc(x1,y1,10,0,2*Math.PI); orbitCtx.fillStyle=ev.color; orbitCtx.fill();
  orbitCtx.beginPath(); orbitCtx.arc(x2,y2,16,0,2*Math.PI); orbitCtx.fillStyle='#ffffff'; orbitCtx.fill();
}

function animateGW(ev){
  cancelAnimationFrame(animFrame);
  let t=0;
  function step(){
    t+=0.01;
    drawGraph(document.getElementById('amplitudeCanvas').getContext('2d'),ev.color,tt=>Math.pow(tt,3)*Math.sin(20*tt*Math.PI*5*t));
    drawGraph(document.getElementById('energyCanvas').getContext('2d'),ev.color,tt=>Math.pow(tt,2.5)*Math.exp(-3*tt*t));
    drawGraph(document.getElementById('freqCanvas').getContext('2d'),ev.color,tt=>tt*tt*t);
    let flash=0; if(t>0.95&&t<1.05) flash=Math.sin((t-0.95)*Math.PI*5);
    drawOrbit(ev,flash);
    orbitAngle+=0.02+ev.spin*0.01;
    if(t<1.2) animFrame=requestAnimationFrame(step);
  }
  step();
}

function drawGraph(ctx,color,func){
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
  ctx.beginPath();
  for(let i=0;i<ctx.canvas.width;i++){
    const t=i/ctx.canvas.width;
    const y=ctx.canvas.height/2 - func(t)*ctx.canvas.height/3;
    i===0?ctx.moveTo(i,y):ctx.lineTo(i,y);
  }
  ctx.strokeStyle=color; ctx.lineWidth=2; ctx.stroke();
}

function playChirp(fStart,fEnd,duration){
  try{
    const audio=new (window.AudioContext||window.webkitAudioContext)();
    const osc=audio.createOscillator(), gain=audio.createGain();
    osc.connect(gain); gain.connect(audio.destination);
    osc.frequency.setValueAtTime(fStart,audio.currentTime);
    osc.frequency.exponentialRampToValueAtTime(fEnd,audio.currentTime+duration);
    gain.gain.setValueAtTime(0.2,audio.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.0001,audio.currentTime+duration);
    osc.start(); osc.stop(audio.currentTime+duration);
  } catch(e){console.log(e);}
}

function updateSummary(m1,m2){
  const chirpMass=Math.pow((m1*m2)**(3/5)/(m1+m2)**(1/5),1);
  document.getElementById('chirpMass').textContent=chirpMass.toFixed(2)+" M‚òâ";
  document.getElementById('freqRange').textContent="20‚Äì400 Hz";
  document.getElementById('gwStrain').textContent=(4e-21*(chirpMass/30)**(5/3)).toExponential(2);
  document.getElementById('distance').textContent=`${(chirpMass*40).toFixed(0)} million ly`;
}

function updateEvent(eventKey){
  const ev=gwEvents[eventKey];
  document.getElementById('eventDescription').textContent=eventDescriptions[eventKey];
  updateSummary(ev.m1,ev.m2);
  animateGW(ev);
}

document.getElementById('runCustomBtn').addEventListener('click',()=>{
  const m1=parseFloat(document.getElementById('m1Input').value);
  const m2=parseFloat(document.getElementById('m2Input').value);
  const spin=parseFloat(document.getElementById('spinInput').value);
  gwEvents["Custom"]={m1,m2,spin,color:'#ffffff'};
  eventDescriptions["Custom"]=`Custom system: m1=${m1} M‚òâ, m2=${m2} M‚òâ, spin=${spin}`;
  eventSelect.value="Custom";
  updateEvent("Custom");
});

document.getElementById('resetBtn').addEventListener('click',()=>updateEvent(eventSelect.value));
document.getElementById('playChirpBtn').addEventListener('click',()=>{
  const ev=gwEvents[eventSelect.value];
  const chirpMass=Math.pow((ev.m1*ev.m2)**(3/5)/(ev.m1+ev.m2)**(1/5),1);
  playChirp(30+ev.spin*10, 300+(chirpMass/30)*300, 2);
});

eventSelect.addEventListener('change',()=>updateEvent(eventSelect.value));
updateEvent("GW150914");

// --- Calculator Tab ---
document.getElementById('runCalcBtn').addEventListener('click',()=>{
  const G=6.67430e-11, M=4.3e6*1.989e30, c=3e8;
  const r=parseFloat(document.getElementById('radiusInput').value);
  const rho=parseFloat(document.getElementById('densityInput').value);
  const gamma=Math.sqrt(1 - (2*G*M)/(r*c*c));
  const alpha=1e21, Gamma_dark=1*(1+alpha*rho);
  document.getElementById('calcResults').innerHTML=
    `<p>Time Dilation Factor (Œ≥): <b>${gamma.toFixed(6)}</b></p>
     <p>Modified Decay Rate (Œì_dark): <b>${Gamma_dark.toExponential(2)}</b></p>`;
  const ctx=document.getElementById('decayCanvas').getContext('2d');
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
  ctx.beginPath();
  for(let i=0;i<ctx.canvas.width;i++){
    const t=i/ctx.canvas.width*10, y=ctx.canvas.height/2 - Math.exp(-Gamma_dark*t)*100;
    i===0?ctx.moveTo (i,y):ctx.lineTo(i,y);
  }
  ctx.strokeStyle="#a64dff"; ctx.lineWidth=2; ctx.stroke();
});
</script>
</body>
</html>
