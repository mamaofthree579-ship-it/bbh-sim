<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sagittarius A* & Gravitational-Wave Simulator</title>
<style>
  body { margin:0; font-family:Arial, sans-serif; background:#05000a; color:white; overflow-x:hidden; }
  .tabs { display:flex; background:#1a001f; border-bottom:2px solid #33003d; }
  .tabButton { flex:1; padding:12px; cursor:pointer; background:#22002b; border:none; color:#e5ccff; font-weight:bold; transition:0.3s; }
  .tabButton:hover { background:#33003d; }
  .tabButton.active { background:#550066; color:white; }
  .tabContent { display:none; padding:20px; }
  canvas { border:1px solid #33003d; border-radius:8px; display:block; margin:15px auto; background:radial-gradient(circle at center, #14001a 0%, #05000a 100%); }
  button, select, input { margin:5px; padding:8px; border:none; border-radius:4px; }
  button { background:#8000ff; color:white; cursor:pointer; transition:0.3s; }
  button:hover { background:#a64dff; }
  #eventInfo, #scienceSummary { background:rgba(30,0,40,0.7); padding:10px; border-radius:8px; margin-top:10px; border:1px solid #33003d; }
  #scienceSummary table { width:100%; border-collapse:collapse; margin-top:5px; }
  #scienceSummary th, #scienceSummary td { text-align:left; padding:6px; border-bottom:1px solid #440055; color:#e5ccff; }
  h2,h3,h4 { color:#e5ccff; }
  #calcResults { background:rgba(40,0,60,0.6); padding:10px; border-radius:8px; border:1px solid #33003d; margin-top:10px; }
  #legend { text-align:center; margin-top:15px; font-size:14px; color:#d0b3ff; }
</style>
</head>
<body>

<!-- Tabs -->
<div class="tabs">
  <button class="tabButton active" data-tab="overviewTab">Overview</button>
  <button class="tabButton" data-tab="eventsTab">Events</button>
</div>

<!-- Overview -->
<div id="overviewTab" class="tabContent" style="display:block;">
  <h2>üåå Sagittarius A* Overview</h2>
  <p>Observe the supermassive black hole at our galaxy‚Äôs center. Adjust parameters to see how gravity and dark matter alter spacetime behavior.</p>
  <canvas id="bhCanvas" width="800" height="400"></canvas>

  <div id="legend">
    <span style="color:#ffcc99;">‚óè</span> Accretion Disk |
    <span style="color:#a64dff;">‚óè</span> Photon Sphere |
    <span style="color:#00ffff;">‚óè</span> Relativistic Jet |
    <span style="color:#ffffff;">‚óè</span> Hotspot
  </div>

  <h3>üßÆ Sagittarius A* Calculator</h3>
  <label>Radius from BH (m):</label>
  <input id="radiusInput" type="number" value="7.8e17" step="1e16">
  <label>Dark-Matter Density (œÅ_DM kg/m¬≥):</label>
  <input id="densityInput" type="number" value="1e-21" step="1e-22">
  <button id="runCalcBtn">Run Simulation</button>
  <div id="calcResults"></div>
</div>

<!-- Events -->
<div id="eventsTab" class="tabContent">
  <h2>üí´ Gravitational-Wave Events</h2>
  <label>Select Event:</label>
  <select id="eventSelect"></select>
  <button id="runCustomBtn">Run Custom</button>
  <button id="resetBtn">Reset</button><br>
  <label>M‚ÇÅ (M‚òâ):</label><input id="m1Input" type="number" value="30">
  <label>M‚ÇÇ (M‚òâ):</label><input id="m2Input" type="number" value="30">
  <label>Spin (a*):</label><input id="spinInput" type="number" value="0.5" step="0.1" min="0" max="1">
  <canvas id="orbitCanvas" width="700" height="400"></canvas>
  <canvas id="chirpCanvas" width="800" height="200"></canvas>
  <button id="playChirpBtn">üîä Play Chirp</button>

  <div id="eventInfo"><strong>Event Information:</strong><p id="eventDescription"></p></div>
  <div id="scienceSummary">
    <strong>Scientific Summary:</strong>
    <table>
      <tr><th>Parameter</th><th>Value</th></tr>
      <tr><td>Chirp Mass (‚Ñ≥)</td><td id="chirpMass">--</td></tr>
      <tr><td>Frequency Range (Hz)</td><td id="freqRange">--</td></tr>
      <tr><td>GW Strain (h)</td><td id="gwStrain">--</td></tr>
      <tr><td>Estimated Distance</td><td id="distance">--</td></tr>
    </table>
    <h4>Chirp Amplitude</h4><canvas id="amplitudeCanvas" width="800" height="200"></canvas>
    <h4>Energy Loss</h4><canvas id="energyCanvas" width="800" height="200"></canvas>
    <h4>Frequency Evolution</h4><canvas id="freqCanvas" width="800" height="200"></canvas>
  </div>
</div>

<script>
// --- Tabs ---
const tabButtons=document.querySelectorAll('.tabButton');
const tabContents=document.querySelectorAll('.tabContent');
tabButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    tabButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    tabContents.forEach(tc=>tc.style.display='none');
    document.getElementById(btn.dataset.tab).style.display='block';
  });
});

// --- Overview Simulation (Sagittarius A*) ---
const bhCanvas=document.getElementById('bhCanvas');
const ctx=bhCanvas.getContext('2d');
let stars=Array.from({length:150},()=>({x:Math.random()*bhCanvas.width,y:Math.random()*bhCanvas.height,r:Math.random()*1.2,t:Math.random()*2*Math.PI}));
let hotspotAngle=0, gamma=1, dmDensity=1e-21;

function drawBH(){
  ctx.clearRect(0,0,bhCanvas.width,bhCanvas.height);
  const cx=bhCanvas.width/2, cy=bhCanvas.height/2;
  const rBH=60;
  // background stars
  stars.forEach(s=>{
    s.t+=0.05;
    let b=0.6+0.4*Math.sin(s.t);
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.r,0,2*Math.PI);
    ctx.fillStyle=`rgba(255,255,255,${b})`;
    ctx.fill();
  });
  // halo based on DM density
  const haloGrad=ctx.createRadialGradient(cx,cy,rBH,cx,cy,250);
  const hue=260+Math.min(dmDensity*1e23,30);
  haloGrad.addColorStop(0,`rgba(0,0,0,1)`);
  haloGrad.addColorStop(1,`hsla(${hue},100%,50%,0.1)`);
  ctx.fillStyle=haloGrad; ctx.fillRect(0,0,bhCanvas.width,bhCanvas.height);
  // accretion disk glow
  const diskGrad=ctx.createRadialGradient(cx,cy,rBH,cx,cy,180);
  const diskBright=Math.max(0.3,(1-gamma)*3);
  diskGrad.addColorStop(0,`rgba(255,180,80,${diskBright})`);
  diskGrad.addColorStop(1,'rgba(255,120,0,0)');
  ctx.beginPath(); ctx.arc(cx,cy,rBH+50,0,2*Math.PI);
  ctx.fillStyle=diskGrad; ctx.fill();
  // black hole core
  ctx.beginPath(); ctx.arc(cx,cy,rBH,0,2*Math.PI);
  ctx.fillStyle='black'; ctx.fill();
  // photon ring
  ctx.beginPath(); ctx.arc(cx,cy,rBH+10,0,2*Math.PI);
  ctx.strokeStyle='rgba(166,77,255,0.5)';
  ctx.lineWidth=2; ctx.stroke();
  // hotspot
  const hsX=cx+Math.cos(hotspotAngle)*100;
  const hsY=cy+Math.sin(hotspotAngle)*40;
  ctx.beginPath(); ctx.arc(hsX,hsY,6,0,2*Math.PI);
  ctx.fillStyle='#ffffff'; ctx.fill();
  // jet
  ctx.beginPath();
  ctx.moveTo(cx,cy-rBH);
  ctx.lineTo(cx,cy-200);
  ctx.strokeStyle='rgba(0,255,255,0.4)';
  ctx.lineWidth=3; ctx.stroke();
  hotspotAngle+=0.03*(1/gamma);
  requestAnimationFrame(drawBH);
}
drawBH();

// --- Linked Calculator ---
document.getElementById('runCalcBtn').addEventListener('click',()=>{
  const G=6.67430e-11, M=4.3e6*1.989e30, c=3e8;
  const r=parseFloat(document.getElementById('radiusInput').value);
  dmDensity=parseFloat(document.getElementById('densityInput').value);
  gamma=Math.sqrt(1 - (G*M)/(r*c*c));
  const alpha=1e21, Gamma_dark=1*(1+alpha*dmDensity);
  document.getElementById('calcResults').innerHTML=
    `<p>Time Dilation Factor (Œ≥): <b>${gamma.toFixed(6)}</b></p>
     <p>Modified Decay Rate (Œì_dark): <b>${Gamma_dark.toExponential(2)}</b></p>`;
});

// --- Events Simulation (restored) ---
const gwEvents={
  "GW150914":{m1:36,m2:29,spin:0.3,color:'#a64dff'},
  "GW170104":{m1:31,m2:19,spin:0.5,color:'#00ccff'},
  "GW190521":{m1:85,m2:66,spin:0.7,color:'#ff66ff'},
  "Custom":{m1:30,m2:30,spin:0.5,color:'#ffffff'}
};
const descriptions={
  "GW150914":"First detection (2015): 36 + 29 M‚òâ merged 1.3 B ly away.",
  "GW170104":"Detected 2017: 31 + 19 M‚òâ merged ~3 B ly away.",
  "GW190521":"Massive (85 + 66 M‚òâ) ‚Äî most energetic GW detected.",
  "Custom":"Custom system based on chosen parameters."
};
const eventSelect=document.getElementById('eventSelect');
for(let e in gwEvents){let o=document.createElement('option');o.value=e;o.text=e;eventSelect.add(o);}
const orbitCanvas=document.getElementById('orbitCanvas'), octx=orbitCanvas.getContext('2d');
let orbitAngle=0;
function drawOrbit(m1,m2,spin,color){
  function loop(){
    octx.clearRect(0,0,orbitCanvas.width,orbitCanvas.height);
    const cx=orbitCanvas.width/2, cy=orbitCanvas.height/2;
    const r1=80, r2=160;
    const x1=cx+Math.cos(orbitAngle)*r1, y1=cy+Math.sin(orbitAngle)*r1;
    const x2=cx-Math.cos(orbitAngle)*r2, y2=cy-Math.sin(orbitAngle)*r2;
    octx.beginPath();octx.arc(x1,y1,10,0,2*Math.PI);octx.fillStyle=color;octx.fill();
    octx.beginPath();octx.arc(x2,y2,16,0,2*Math.PI);octx.fillStyle='#fff';octx.fill();
    orbitAngle+=0.02+spin*0.01;requestAnimationFrame(loop);
  }loop();
}
function graph(ctx,color,fn){
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
  ctx.beginPath();
  for(let i=0;i<ctx.canvas.width;i++){
    let t=i/ctx.canvas.width;
    let y=ctx.canvas.height/2 - fn(t)*ctx.canvas.height/3;
    i===0?ctx.moveTo(i,y):ctx.lineTo(i,y);
  }
  ctx.strokeStyle=color; ctx.lineWidth=2; ctx.stroke();
}
function playChirp(f1,f2,d){
  try{
    const a=new (window.AudioContext||window.webkitAudioContext)();
    const o=a.createOscillator(), g=a.createGain();
    o.connect(g);g.connect(a.destination);
    o.frequency.setValueAtTime(f1,a.currentTime);
    o.frequency.exponentialRampToValueAtTime(f2,a.currentTime+d);
    g.gain.setValueAtTime(0.2,a.currentTime);
    g.gain.exponentialRampToValueAtTime(0.0001,a.currentTime+d);
    o.start();o.stop(a.currentTime+d);
  }catch(e){console.log(e);}
}
function updateSummary(m1,m2){
  const chirp=Math.pow((m1*m2)**(3/5)/(m1+m2)**(1/5),1);
  document.getElementById('chirpMass').textContent=chirp.toFixed(2)+" M‚òâ";
  document.getElementById('freqRange').textContent="20‚Äì400 Hz";
  document.getElementById('gwStrain').textContent=(4e-21*(chirp/30)**(5/3)).toExponential(2);
  document.getElementById('distance').textContent=`${(chirp*40).toFixed(0)} million ly`;
}
function updateEvent(key){
  const e=gwEvents[key];
  document.getElementById('eventDescription').textContent=descriptions[key];
  drawOrbit(e.m1,e.m2,e.spin,e.color);
  updateSummary(e.m1,e.m2);
  graph(document.getElementById('amplitudeCanvas').getContext('2d'),e.color,t=>Math.pow(t,3)*Math.sin(30*t));
  graph(document.getElementById('energyCanvas').getContext('2d'),e.color,t=>Math.pow(t,2.5)*Math.exp(-3*t));
  graph(document.getElementById('freqCanvas').getContext('2d'),e.color,t=>t*t);
}
document.getElementById('runCustomBtn').addEventListener('click',()=>{
  let m1=parseFloat(m1Input.value),m2=parseFloat(m2Input.value),s=parseFloat(spinInput.value);
  gwEvents.Custom={m1,m2,spin:s,color:'#fff'};
  descriptions.Custom=`Custom: m1=${m1}, m2=${m2}, spin=${s}`;
  eventSelect.value='Custom'; updateEvent('Custom');
});
document.getElementById('resetBtn').addEventListener('click',()=>updateEvent(eventSelect.value));
document.getElementById('playChirpBtn').addEventListener('click',()=>{
  const e=gwEvents[eventSelect.value];
  const chirp=Math.pow((e.m1*e.m2)**(3/5)/(e.m1+e.m2)**(1/5),1);
  const f1=30+e.spin*10, f2=300+(chirp/30)*300;
  playChirp(f1,f2,2);
});
eventSelect.addEventListener('change',()=>updateEvent(eventSelect.value));
updateEvent("GW150914");
</script>
</body>
</html>
