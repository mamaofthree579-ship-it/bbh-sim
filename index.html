<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Black Hole & GW Simulator</title>
<style>
  body { margin:0; font-family:Arial, sans-serif; background:#05000a; color:white; overflow-x:hidden; }
  .tabs { display:flex; background:#1a001f; border-bottom:2px solid #33003d; }
  .tabButton { flex:1; padding:12px; cursor:pointer; background:#22002b; border:none; color:#e5ccff; transition:0.3s; font-weight:bold; }
  .tabButton:hover { background:#33003d; }
  .tabButton.active { background:#550066; color:#fff; }
  .tabContent { display:none; padding:20px; }
  canvas { border:1px solid #33003d; border-radius:8px; display:block; margin:15px auto; background:radial-gradient(circle at center, #14001a 0%, #05000a 100%); }
  button, select, input { margin:5px 0; padding:8px; border:none; border-radius:4px; }
  button { background:#8000ff; color:white; cursor:pointer; transition:0.3s; }
  button:hover { background:#a64dff; }
  #eventInfo, #scienceSummary { background:rgba(30,0,40,0.7); padding:10px; border-radius:8px; margin-top:10px; border:1px solid #33003d; }
  #scienceSummary table { width:100%; border-collapse:collapse; margin-top:5px; }
  #scienceSummary th, #scienceSummary td { text-align:left; padding:6px; border-bottom:1px solid #440055; color:#e5ccff; }
  h2, h3, h4 { color:#e5ccff; }
  label { margin-right:6px; }
  input[type="range"] { width:150px; vertical-align:middle; }
</style>
</head>
<body>

<!-- Tabs -->
<div class="tabs">
  <button class="tabButton active" data-tab="overviewTab">Overview</button>
  <button class="tabButton" data-tab="eventsTab">Events</button>
</div>

<!-- Overview -->
<div id="overviewTab" class="tabContent" style="display:block;">
  <h2>üåå Black Hole Overview</h2>
  <p>Visualize a rotating black hole surrounded by its glowing accretion disk ‚Äî light bent by extreme gravity.</p>
  <canvas id="bhCanvas" width="800" height="400"></canvas>
</div>

<!-- Events -->
<div id="eventsTab" class="tabContent">
  <h2>üí´ Gravitational-Wave Events</h2>
  <label for="eventSelect">Select Event:</label>
  <select id="eventSelect"></select><br>
  <button id="runCustomBtn">Run Custom Simulation</button><br>
  <label>M‚ÇÅ (M‚òâ):</label><input id="m1Input" type="number" value="30" step="0.1">
  <label>M‚ÇÇ (M‚òâ):</label><input id="m2Input" type="number" value="30" step="0.1"><br>
  <label>Spin‚ÇÅ:</label><input id="spin1Input" type="range" min="-1" max="1" value="0" step="0.01">
  <span id="spin1Val">0</span>
  <label>Spin‚ÇÇ:</label><input id="spin2Input" type="range" min="-1" max="1" value="0" step="0.01">
  <span id="spin2Val">0</span>

  <canvas id="orbitCanvas" width="700" height="400"></canvas>
  <canvas id="chirpCanvas" width="800" height="200"></canvas>
  <button id="playChirpBtn">üîä Play Chirp</button>

  <div id="eventInfo">
    <strong>Event Information:</strong>
    <p id="eventDescription"></p>
  </div>

  <div id="scienceSummary">
    <strong>Scientific Summary:</strong>
    <table>
      <tr><th>Parameter</th><th>Value</th></tr>
      <tr><td>Chirp Mass (‚Ñ≥)</td><td id="chirpMass">--</td></tr>
      <tr><td>Frequency Range (Hz)</td><td id="freqRange">--</td></tr>
      <tr><td>GW Strain (h)</td><td id="gwStrain">--</td></tr>
      <tr><td>Estimated Distance</td><td id="distance">--</td></tr>
    </table>
    <h4>Chirp Amplitude Graph</h4>
    <canvas id="amplitudeCanvas" width="800" height="200"></canvas>
    <h4>Energy Loss Rate</h4>
    <canvas id="energyCanvas" width="800" height="200"></canvas>
    <h4>Frequency Evolution</h4>
    <canvas id="freqCanvas" width="800" height="200"></canvas>
  </div>
</div>

<script>
// --- Tabs ---
const tabButtons=document.querySelectorAll('.tabButton');
const tabContents=document.querySelectorAll('.tabContent');
tabButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    tabButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    tabContents.forEach(tc=>tc.style.display='none');
    document.getElementById(btn.dataset.tab).style.display='block';
  });
});

// --- Overview Stars + BH ---
const bhCanvas=document.getElementById('bhCanvas');
const bhCtx=bhCanvas.getContext('2d');
const stars=Array.from({length:150},()=>({
  x:Math.random()*bhCanvas.width,
  y:Math.random()*bhCanvas.height,
  r:Math.random()*1.5,
  tw:Math.random()*Math.PI*2
}));
let angle=0;
function drawBH(){
  bhCtx.clearRect(0,0,bhCanvas.width,bhCanvas.height);
  for(let s of stars){
    if(Math.hypot(s.x-bhCanvas.width/2,s.y-bhCanvas.height/2)<70) continue;
    bhCtx.beginPath();
    bhCtx.arc(s.x,s.y,s.r+Math.sin(s.tw)*0.5,0,Math.PI*2);
    bhCtx.fillStyle='rgba(255,255,255,0.8)';
    bhCtx.fill();
    s.tw+=0.02;
  }
  const cx=bhCanvas.width/2, cy=bhCanvas.height/2;
  const grad=bhCtx.createRadialGradient(cx,cy,10,cx,cy,200);
  grad.addColorStop(0,'#000');
  grad.addColorStop(1,'#33003d');
  bhCtx.fillStyle=grad;
  bhCtx.fillRect(0,0,bhCanvas.width,bhCanvas.height);
  bhCtx.beginPath();
  bhCtx.arc(cx,cy,50,0,Math.PI*2);
  bhCtx.fillStyle='black';
  bhCtx.fill();
  for(let i=0;i<120;i++){
    bhCtx.beginPath();
    bhCtx.arc(cx,cy,55+i,0,Math.PI*2);
    bhCtx.strokeStyle=`rgba(180,0,255,${0.015})`;
    bhCtx.stroke();
  }
  const x=cx+Math.cos(angle)*100;
  const y=cy+Math.sin(angle)*30;
  bhCtx.beginPath();
  bhCtx.arc(x,y,6,0,Math.PI*2);
  bhCtx.fillStyle='#ffcc99';
  bhCtx.fill();
  angle+=0.03;
  requestAnimationFrame(drawBH);
}
drawBH();

// --- GW Events Data ---
const gwEvents={
  "GW150914":{m1:36,m2:29,spin1:0.3,spin2:-0.2},
  "GW170104":{m1:31,m2:19,spin1:0.1,spin2:0.05},
  "Custom":{m1:30,m2:30,spin1:0,spin2:0}
};
const eventDescriptions={
  "GW150914":"First gravitational wave detection (2015): two black holes of 36 and 29 solar masses merged 1.3 billion light-years away.",
  "GW170104":"2017 detection: merger of 31 and 19 solar-mass black holes, ~3 billion light-years away.",
  "Custom":"Set custom masses and spins to simulate your own event."
};
const eventSelect=document.getElementById('eventSelect');
for(let e in gwEvents){
  const opt=document.createElement('option');
  opt.value=e; opt.text=e;
  eventSelect.add(opt);
}

// --- Orbit Simulation ---
const orbitCanvas=document.getElementById('orbitCanvas');
const orbitCtx=orbitCanvas.getContext('2d');
let orbitAngle=0, trails=[];
function drawOrbit(m1,m2,spin1,spin2){
  orbitCtx.clearRect(0,0,orbitCanvas.width,orbitCanvas.height);
  const cx=orbitCanvas.width/2, cy=orbitCanvas.height/2;
  const r1=70, r2=140;
  const x1=cx+Math.cos(orbitAngle)*r1;
  const y1=cy+Math.sin(orbitAngle)*r1;
  const x2=cx-Math.cos(orbitAngle)*r2;
  const y2=cy-Math.sin(orbitAngle)*r2;

  trails.push({x1,y1,x2,y2});
  if(trails.length>100) trails.shift();
  orbitCtx.fillStyle='rgba(10,0,20,0.6)';
  orbitCtx.fillRect(0,0,orbitCanvas.width,orbitCanvas.height);

  for(let t of trails){
    orbitCtx.beginPath();
    orbitCtx.arc(t.x1,t.y1,1.5,0,Math.PI*2);
    orbitCtx.fillStyle='rgba(255,100,255,0.3)';
    orbitCtx.fill();
    orbitCtx.beginPath();
    orbitCtx.arc(t.x2,t.y2,1.5,0,Math.PI*2);
    orbitCtx.fillStyle='rgba(100,255,255,0.3)';
    orbitCtx.fill();
  }

  orbitCtx.beginPath();
  orbitCtx.arc(x1,y1,10,0,Math.PI*2);
  orbitCtx.fillStyle='#ff66ff';
  orbitCtx.fill();
  orbitCtx.save();
  orbitCtx.translate(x1,y1);
  orbitCtx.rotate(spin1*10);
  orbitCtx.beginPath();
  orbitCtx.arc(0,0,14,0,Math.PI*2);
  orbitCtx.strokeStyle='rgba(255,255,255,0.4)';
  orbitCtx.stroke();
  orbitCtx.restore();

  orbitCtx.beginPath();
  orbitCtx.arc(x2,y2,16,0,Math.PI*2);
  orbitCtx.fillStyle='#00ccff';
  orbitCtx.fill();
  orbitCtx.save();
  orbitCtx.translate(x2,y2);
  orbitCtx.rotate(spin2*10);
  orbitCtx.beginPath();
  orbitCtx.arc(0,0,20,0,Math.PI*2);
  orbitCtx.strokeStyle='rgba(255,255,255,0.4)';
  orbitCtx.stroke();
  orbitCtx.restore();

  orbitAngle+=0.02;
  requestAnimationFrame(()=>drawOrbit(m1,m2,spin1,spin2));
}

// --- Chirp, Graphs, Audio, Summary ---
let currentEvent={m1:30,m2:30,spin1:0,spin2:0};
function updateEvent(key){
  const ev=gwEvents[key];
  if(!ev) return;
  currentEvent=ev;
  document.getElementById('eventDescription').textContent=eventDescriptions[key];
  drawOrbit(ev.m1,ev.m2,ev.spin1,ev.spin2);
  updateSummary(ev.m1,ev.m2,ev.spin1,ev.spin2);
  drawGraphs();
}

function updateSummary(m1,m2,spin1,spin2){
  const chirpMass=Math.pow((m1*m2)**(3/5)/(m1+m2)**(1/5),1);
  document.getElementById('chirpMass').textContent=chirpMass.toFixed(2)+" M‚òâ";
  document.getElementById('freqRange').textContent="20‚Äì400 Hz";
  document.getElementById('gwStrain').textContent=(4e-21*(chirpMass/30)**(5/3)).toExponential(2);
  document.getElementById('distance').textContent=`${(chirpMass*40).toFixed(0)} million ly`;
}

function drawGraphs(){
  const ampCtx=document.getElementById('amplitudeCanvas').getContext('2d');
  const energyCtx=document.getElementById('energyCanvas').getContext('2d');
  const freqCtx=document.getElementById('freqCanvas').getContext('2d');
  const graphs=[
    [ampCtx,'#a64dff',t=>Math.pow(t,3)*Math.sin(40*t*Math.PI)],
    [energyCtx,'#ff66ff',t=>Math.pow(t,2.5)*Math.exp(-3*t)],
    [freqCtx,'#00ccff',t=>t*t]
  ];
  graphs.forEach(([ctx,color,fn])=>{
    ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
    ctx.beginPath();
    for(let i=0;i<ctx.canvas.width;i++){
      const t=i/ctx.canvas.width;
      const y=ctx.canvas.height/2 - fn(t)*ctx.canvas.height/3;
      if(i===0) ctx.moveTo(i,y); else ctx.lineTo(i,y);
    }
    ctx.strokeStyle=color;
    ctx.lineWidth=2;
    ctx.stroke();
  });
}

// --- Reset ---
function resetSimulator(){
  trails=[];
  orbitAngle=0;
  drawOrbit(currentEvent.m1,currentEvent.m2,currentEvent.spin1,currentEvent.spin2);
  drawGraphs();
}

// --- Spin Slider Handlers ---
document.getElementById('spin1Input').addEventListener('input',e=>{
  document.getElementById('spin1Val').textContent=e.target.value;
});
document.getElementById('spin2Input').addEventListener('input',e=>{
  document.getElementById('spin2Val').textContent=e.target.value;
});

// --- Custom ---
document.getElementById('runCustomBtn').addEventListener('click',()=>{
  const m1=parseFloat(document.getElementById('m1Input').value);
  const m2=parseFloat(document.getElementById('m2Input').value);
  const spin1=parseFloat(document.getElementById('spin1Input').value);
  const spin2=parseFloat(document.getElementById('spin2Input').value);
  gwEvents["Custom"]={m1,m2,spin1,spin2};
  eventDescriptions["Custom"]= `Custom simulation: m1=${m1} M‚òâ, m2=${m2} M‚òâ, spin‚ÇÅ=${spin1}, spin‚ÇÇ=${spin2}`;
  eventSelect.value="Custom";
  updateEvent("Custom");
});

// --- Reset Button ---
const resetBtn=document.createElement('button');
resetBtn.textContent="üîÑ Reset Simulator";
resetBtn.style.marginTop="10px";
resetBtn.addEventListener('click',resetSimulator);
document.getElementById('eventsTab').appendChild(resetBtn);

// --- Init ---
eventSelect.addEventListener('change',()=>updateEvent(eventSelect.value));
updateEvent("GW150914");
</script>
</body>
</html>
